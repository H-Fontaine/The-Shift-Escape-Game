main_database = [[38502761,"LunarTransport",68362850,"Lunestone",33813.87],
[35673565,"Solgona",35673565,"Solgona",63884.12],
[68365833,"Moonbrite",17452966,"Moon&Co",116233.6],
[38502761,"LunarTransport",17452966,"Moon&Co",76086.27],
[68365833,"Moonbrite",17452966,"Moon&Co",31013.92],
[78162537,"Far Away Limited",96877928,"Spero",8157.339],
[38502761,"LunarTransport",68362850,"Lunestone",103300.8],
[78162537,"Far Away Limited",96877928,"Spero",5673.133],
[68365833,"Moonbrite",67456889,"Luneca",70732.8],
[38502761,"LunarTransport",68362850,"Lunestone",56198.9],
[38502761,"LunarTransport",38502761,"LunarTransport",125847.6],
[25419991,"CoMoonIcations",17452966,"Moon&Co",54470.02],
[98578956,"CoMoonIcations",57326522,"LisaLuna",79781.53],
[67456889,"Luneca",68362850,"Lunestone",44141.59],
[17452966,"Moon&Co",38502761,"LunarTransport",24363.16],
[32017455,"Sirota",68365833,"Moonbrite",79360.49],
[68365833,"Moonbrite",25419991,"CoMoonIcations",43484.78],
[32017455,"Sirota",35673565,"Solgona",74667.19],
[17452966,"Moon&Co",78162537,"Far Away Limited",83400.26],
[35673565,"Solgona",35673565,"Solgona",57090.79],
[32017455,"Sirota",78162537,"Far Away Limited",12098.63],
[68362850,"Lunestone",17452966,"Moon&Co",56484.94],
[98578956,"CoMoonIcations",96877928,"Spero",52469.91],
[98578956,"CoMoonIcations",68365833,"Moonbrite",101520.4],
[57326522,"LisaLuna",78162537,"Far Away Limited",45776.98],
[98578956,"CoMoonIcations",25419991,"CoMoonIcations",11005.22],
[35673565,"Solgona",96877928,"Spero",6934.526],
[57326522,"LisaLuna",17452966,"Moon&Co",25060.08],
[78162537,"Far Away Limited",96877928,"Spero",26994.33],
[68362850,"Lunestone",17452966,"Moon&Co",59534.25],
[96877928,"Spero",78162537,"Far Away Limited",69915.02],
[38502761,"LunarTransport",32017455,"Sirota",18437.42],
[68362850,"Lunestone",57326522,"LisaLuna",31769.33],
[17452966,"Moon&Co",68365833,"Moonbrite",65422.8],
[35673565,"Solgona",35673565,"Solgona",27503.68],
[68362850,"Lunestone",25419991,"CoMoonIcations",66587.97],
[78162537,"Far Away Limited",38502761,"LunarTransport",95483.18],
[96877928,"Spero",67456889,"Luneca",10682.26],
[68365833,"Moonbrite",25419991,"CoMoonIcations",38222.36],
[25419991,"CoMoonIcations",57326522,"LisaLuna",75744.62],
[67456889,"Luneca",57326522,"LisaLuna",32301.56],
[35673565,"Solgona",67456889,"Luneca",45019.8],
[67456889,"Luneca",98578956,"Luneca",64366.59],
[68362850,"Lunestone",96877928,"Spero",22271.01],
[78162537,"Far Away Limited",25419991,"CoMoonIcations",116005.6],
[78162537,"Far Away Limited",98578956,"Luneca",81916.63],
[98578956,"CoMoonIcations",96877928,"Spero",30001.08],
[96877928,"Spero",68362850,"Lunestone",74302.33],
[68362850,"Lunestone",68365833,"Moonbrite",18423.02],
[96877928,"Spero",38502761,"LunarTransport",26992.7],
[96877928,"Spero",57326522,"LisaLuna",57447.96],
[25419991,"CoMoonIcations",25419991,"CoMoonIcations",31506.55],
[78162537,"Far Away Limited",67456889,"Luneca",54373.39],
[57326522,"LisaLuna",96877928,"Spero",9838.865],
[96877928,"Spero",68365833,"Moonbrite",30294.63],
[38502761,"LunarTransport",68362850,"Lunestone",82240.05],
[35673565,"Solgona",35673565,"Solgona",104039.2],
[38502761,"LunarTransport",25419991,"CoMoonIcations",31001.07],
[67456889,"Luneca",98578956,"Luneca",77140.07],
[38502761,"LunarTransport",32017455,"Sirota",122659.0],
[35673565,"Solgona",17452966,"Moon&Co",74305.8],
[57326522,"LisaLuna",38502761,"LunarTransport",21007.23],
[17452966,"Moon&Co",98578956,"Luneca",43473.57],
[68365833,"Moonbrite",38502761,"LunarTransport",27028.01],
[32017455,"Sirota",57326522,"LisaLuna",69341.71],
[57326522,"LisaLuna",57326522,"LisaLuna",5673.842],
[78162537,"Far Away Limited",78162537,"Far Away Limited",74293.02],
[67456889,"Luneca",67456889,"Luneca",93239.06],
[32017455,"Sirota",35673565,"Solgona",58802.89],
[35673565,"Solgona",25419991,"CoMoonIcations",55610.08],
[35673565,"Solgona",68362850,"Lunestone",113594.6],
[67456889,"Luneca",98578956,"Luneca",37698.07],
[32017455,"Sirota",17452966,"Moon&Co",5755.993],
[68362850,"Lunestone",35673565,"Solgona",32306.16],
[57326522,"LisaLuna",38502761,"LunarTransport",53907.58],
[96877928,"Spero",68365833,"Moonbrite",47709.78],
[25419991,"CoMoonIcations",96877928,"Spero",29925.94],
[25419991,"CoMoonIcations",38502761,"LunarTransport",122158.6],
[96877928,"Spero",32017455,"Sirota",109191.7],
[78162537,"Far Away Limited",17452966,"Moon&Co",77469.62],
[98578956,"CoMoonIcations",68365833,"Moonbrite",5128.799],
[68362850,"Lunestone",78162537,"Far Away Limited",43106.33],
[98578956,"CoMoonIcations",98578956,"Luneca",76783.63],
[38502761,"LunarTransport",98578956,"Luneca",91701.85],
[96877928,"Spero",98578956,"Luneca",49947.68],
[25419991,"CoMoonIcations",98578956,"Luneca",28757.49],
[96877928,"Spero",98578956,"Luneca",6931.84],
[25419991,"CoMoonIcations",25419991,"CoMoonIcations",47342.84],
[78162537,"Far Away Limited",98578956,"Luneca",29537.17],
[78162537,"Far Away Limited",96877928,"Spero",65976.5],
[68362850,"Lunestone",96877928,"Spero",56195.81],
[17452966,"Moon&Co",67456889,"Luneca",79373.29],
[78162537,"Far Away Limited",98578956,"Luneca",115587.7],
[57326522,"LisaLuna",98578956,"Luneca",16400.21],
[78162537,"Far Away Limited",35673565,"Solgona",28608.02],
[78162537,"Far Away Limited",38502761,"LunarTransport",128159.0],
[38502761,"LunarTransport",25419991,"CoMoonIcations",100664.9],
[35673565,"Solgona",68365833,"Moonbrite",116423.6],
[35673565,"Solgona",98578956,"Luneca",78637.25],
[32017455,"Sirota",98578956,"Luneca",4843.284],
[68365833,"Moonbrite",25419991,"CoMoonIcations",62062.98],
[25419991,"CoMoonIcations",25419991,"CoMoonIcations",7992.767],
[35673565,"Solgona",17452966,"Moon&Co",70490.39],
[96877928,"Spero",25419991,"CoMoonIcations",73674.77],
[98578956,"CoMoonIcations",96877928,"Spero",54053.86],
[17452966,"Moon&Co",32017455,"Sirota",91701.76],
[68365833,"Moonbrite",25419991,"CoMoonIcations",29001.38],
[25419991,"CoMoonIcations",32017455,"Sirota",34015.09],
[68362850,"Lunestone",57326522,"LisaLuna",4227.14],
[35673565,"Solgona",25419991,"CoMoonIcations",93232.39],
[96877928,"Spero",32017455,"Sirota",126331.2],
[98578956,"CoMoonIcations",78162537,"Far Away Limited",109215.9],
[17452966,"Moon&Co",68362850,"Lunestone",73664.68],
[35673565,"Solgona",38502761,"LunarTransport",5054.636],
[68365833,"Moonbrite",32017455,"Sirota",11440.28],
[25419991,"CoMoonIcations",68362850,"Lunestone",127694.5],
[96877928,"Spero",25419991,"CoMoonIcations",74608.68],
[35673565,"Solgona",67456889,"Luneca",94804.95],
[67456889,"Luneca",32017455,"Sirota",9703.298],
[78162537,"Far Away Limited",32017455,"Sirota",86783.68],
[17452966,"Moon&Co",32017455,"Sirota",43020.64],
[96877928,"Spero",38502761,"LunarTransport",33290.37],
[35673565,"Solgona",17452966,"Moon&Co",87642.9],
[68365833,"Moonbrite",98578956,"Luneca",19024.48],
[25419991,"CoMoonIcations",38502761,"LunarTransport",119867.0],
[38502761,"LunarTransport",38502761,"LunarTransport",4639.524],
[78162537,"Far Away Limited",25419991,"CoMoonIcations",54450.21],
[38502761,"LunarTransport",38502761,"LunarTransport",52682.66],
[25419991,"CoMoonIcations",17452966,"Moon&Co",65070.52],
[57326522,"LisaLuna",35673565,"Solgona",37395.83],
[78162537,"Far Away Limited",32017455,"Sirota",67147.03],
[68365833,"Moonbrite",78162537,"Far Away Limited",78715.81],
[32017455,"Sirota",38502761,"LunarTransport",21965.22],
[25419991,"CoMoonIcations",17452966,"Moon&Co",78668.78],
[38502761,"LunarTransport",35673565,"Solgona",21544.97],
[32017455,"Sirota",25419991,"CoMoonIcations",6783.646],
[35673565,"Solgona",32017455,"Sirota",118072.3],
[68365833,"Moonbrite",25419991,"CoMoonIcations",77542.86],
[98578956,"CoMoonIcations",98578956,"Luneca",26478.1],
[17452966,"Moon&Co",25419991,"CoMoonIcations",60290.9],
[25419991,"CoMoonIcations",96877928,"Spero",44927.95],
[38502761,"LunarTransport",35673565,"Solgona",22272.96],
[98578956,"CoMoonIcations",25419991,"CoMoonIcations",103677.6],
[67456889,"Luneca",67456889,"Luneca",70728.82],
[17452966,"Moon&Co",68365833,"Moonbrite",22860.85],
[38502761,"LunarTransport",17452966,"Moon&Co",100644.3],
[67456889,"Luneca",78162537,"Far Away Limited",51035.56],
[38502761,"LunarTransport",17452966,"Moon&Co",41189.42],
[32017455,"Sirota",17452966,"Moon&Co",114882.1],
[17452966,"Moon&Co",96877928,"Spero",118547.8],
[68362850,"Lunestone",96877928,"Spero",81258.89],
[78162537,"Far Away Limited",38502761,"LunarTransport",29490.03],
[57326522,"LisaLuna",67456889,"Luneca",111182.0],
[68362850,"Lunestone",17452966,"Moon&Co",83388.24],
[17452966,"Moon&Co",57326522,"LisaLuna",46594.06],
[78162537,"Far Away Limited",96877928,"Spero",45395.93],
[17452966,"Moon&Co",25419991,"CoMoonIcations",40220.97],
[38502761,"LunarTransport",98578956,"Luneca",81726.73],
[78162537,"Far Away Limited",32017455,"Sirota",116253.4],
[98578956,"CoMoonIcations",38502761,"LunarTransport",20194.83],
[68365833,"Moonbrite",96877928,"Spero",41555.18],
[57326522,"LisaLuna",68365833,"Moonbrite",85091.06],
[67456889,"Luneca",67456889,"Luneca",12382.77],
[25419991,"CoMoonIcations",68365833,"Moonbrite",10358.16],
[96877928,"Spero",57326522,"LisaLuna",33800.69],
[38502761,"LunarTransport",68362850,"Lunestone",5129.619],
[17452966,"Moon&Co",25419991,"CoMoonIcations",98444.58],
[25419991,"CoMoonIcations",96877928,"Spero",30761.13],
[96877928,"Spero",68365833,"Moonbrite",105648.9],
[38502761,"LunarTransport",17452966,"Moon&Co",70084.21],
[78162537,"Far Away Limited",57326522,"LisaLuna",66812.92],
[38502761,"LunarTransport",17452966,"Moon&Co",117595.6],
[57326522,"LisaLuna",35673565,"Solgona",92458.81],
[17452966,"Moon&Co",38502761,"LunarTransport",36667.82],
[38502761,"LunarTransport",68365833,"Moonbrite",41494.04],
[32017455,"Sirota",96877928,"Spero",35620.43],
[96877928,"Spero",32017455,"Sirota",118088.0],
[32017455,"Sirota",25419991,"CoMoonIcations",48490.05],
[25419991,"CoMoonIcations",98578956,"Luneca",58131.9],
[25419991,"CoMoonIcations",32017455,"Sirota",47161.31],
[25419991,"CoMoonIcations",68365833,"Moonbrite",17966.04],
[98578956,"CoMoonIcations",57326522,"LisaLuna",42458.77],
[78162537,"Far Away Limited",57326522,"LisaLuna",12993.18],
[68362850,"Lunestone",78162537,"Far Away Limited",57385.56],
[35673565,"Solgona",98578956,"Luneca",47730.51],
[68365833,"Moonbrite",68362850,"Lunestone",57106.92],
[67456889,"Luneca",38502761,"LunarTransport",79377.58],
[35673565,"Solgona",17452966,"Moon&Co",21542.47],
[25419991,"CoMoonIcations",25419991,"CoMoonIcations",22983.71],
[78162537,"Far Away Limited",38502761,"LunarTransport",91966.98],
[25419991,"CoMoonIcations",96877928,"Spero",17730.9],
[38502761,"LunarTransport",67456889,"Luneca",33631.04],
[68362850,"Lunestone",35673565,"Solgona",111280.3],
[98578956,"CoMoonIcations",98578956,"Luneca",38620.75],
[96877928,"Spero",32017455,"Sirota",19591.2],
[78162537,"Far Away Limited",78162537,"Far Away Limited",118518.7],
[78162537,"Far Away Limited",32017455,"Sirota",80292.82],
[78162537,"Far Away Limited",98578956,"Luneca",10788.79],
[57326522,"LisaLuna",35673565,"Solgona",87171.82],
[92305923,"Marketoont",48644524,"A1,Stone",77517.68],
[15546787,"Iphinstone",48644524,"A1,Stone",77462.31],
[92305923,"Marketoont",48644524,"A1,Stone",73917.4],
[48644524,"A1,Stone",98578956,"Iphinstone",21008.62],
[92305923,"Marketoont",98578956,"Iphinstone",97124.53],
[48644524,"A1,Stone",92305923,"Marketoont",99782.33],
[15546787,"Iphinstone",92305923,"Marketoont",70344.11],
[48644524,"A1,Stone",15546787,"Iphinstone",33285.33],
[48644524,"A1,Stone",48644524,"A1,Stone",82716.85],
[15546787,"Iphinstone",48644524,"A1,Stone",24098.38],
[15546787,"Iphinstone",79102938,"Mach,Storage",106401.8],
[48644524,"A1,Stone",48644524,"A1,Stone",96310.11],
[15546787,"Iphinstone",92305923,"Marketoont",68822.12],
[92305923,"Marketoont",15546787,"Iphinstone",110012.4],
[98578956,"Iphinstone",98578956,"Iphinstone",83221.57],
[98578956,"Iphinstone",98578956,"Iphinstone",43864.76],
[48644524,"A1,Stone",15546787,"Iphinstone",99767.95],
[92305923,"Marketoont",98578956,"Iphinstone",46568.4],
[79102938,"Mach,Storage",48644524,"A1,Stone",15231.81],
[15546787,"Iphinstone",48644524,"A1,Stone",85690.03],
[98578956,"Iphinstone",48644524,"A1,Stone",84941.7],
[92305923,"Marketoont",92305923,"Marketoont",68946.65],
[92305923,"Marketoont",48644524,"A1,Stone",9062.642],
[92305923,"Marketoont",48644524,"A1,Stone",10141.61],
[98578956,"Iphinstone",48644524,"A1,Stone",59396.91],
[48644524,"A1,Stone",92305923,"Marketoont",46043.51],
[92305923,"Marketoont",79102938,"Mach,Storage",66407.32],
[92305923,"Marketoont",98578956,"Iphinstone",71071.49],
[48644524,"A1,Stone",48644524,"A1,Stone",77759.98],
[15546787,"Iphinstone",48644524,"A1,Stone",35508.37],
[92305923,"Marketoont",98578956,"Iphinstone",41829.2],
[48644524,"A1,Stone",98578956,"Iphinstone",44411.84],
[48644524,"A1,Stone",98578956,"Iphinstone",78298.23],
[98578956,"Iphinstone",15546787,"Iphinstone",7141.242],
[48644524,"A1,Stone",48644524,"A1,Stone",91440.64],
[92305923,"Marketoont",48644524,"A1,Stone",5400.672],
[48644524,"A1,Stone",15546787,"Iphinstone",91483.98],
[98578956,"Iphinstone",79102938,"Mach,Storage",14552.01],
[98578956,"Iphinstone",92305923,"Marketoont",27685.09],
[48644524,"A1,Stone",98578956,"Iphinstone",71051.45],
[48644524,"A1,Stone",48644524,"A1,Stone",42478.34],
[48644524,"A1,Stone",48644524,"A1,Stone",104833.5],
[92305923,"Marketoont",98578956,"Iphinstone",74667.62],
[92305923,"Marketoont",48644524,"A1,Stone",81591.56],
[48644524,"A1,Stone",15546787,"Iphinstone",6226.914],
[98578956,"Iphinstone",98578956,"Iphinstone",20056.24],
[48644524,"A1,Stone",15546787,"Iphinstone",52768.76],
[92305923,"Marketoont",48644524,"A1,Stone",53915.68],
[98578956,"Iphinstone",48644524,"A1,Stone",19123.59],
[92305923,"Marketoont",79102938,"Mach,Storage",46310.96],
[98578956,"Iphinstone",48644524,"A1,Stone",32793.91],
[92305923,"Marketoont",48644524,"A1,Stone",54454.57],
[79102938,"Mach,Storage",48644524,"A1,Stone",53591.47],
[79102938,"Mach,Storage",48644524,"A1,Stone",64171.7],
[92305923,"Marketoont",92305923,"Marketoont",75011.93],
[92305923,"Marketoont",48644524,"A1,Stone",24361.24],
[15546787,"Iphinstone",92305923,"Marketoont",104619.8],
[92305923,"Marketoont",48644524,"A1,Stone",85512.11],
[98578956,"Iphinstone",92305923,"Marketoont",55393.97],
[92305923,"Marketoont",98578956,"Iphinstone",113092.6],
[48644524,"A1,Stone",98578956,"Iphinstone",124494.1],
[98578956,"Iphinstone",15546787,"Iphinstone",28451.06],
[98578956,"Iphinstone",92305923,"Marketoont",115994.7],
[92305923,"Marketoont",92305923,"Marketoont",35437.4],
[48644524,"A1,Stone",48644524,"A1,Stone",69639.93],
[92305923,"Marketoont",15546787,"Iphinstone",45780.84],
[48644524,"A1,Stone",15546787,"Iphinstone",51039.65],
[48644524,"A1,Stone",48644524,"A1,Stone",86795.12],
[98578956,"Iphinstone",48644524,"A1,Stone",48359.58],
[48644524,"A1,Stone",48644524,"A1,Stone",8204.529],
[92305923,"Marketoont",48644524,"A1,Stone",50200.69],
[15546787,"Iphinstone",92305923,"Marketoont",32306.23],
[79102938,"Mach,Storage",48644524,"A1,Stone",120898.4],
[48644524,"A1,Stone",15546787,"Iphinstone",33643.69],
[92305923,"Marketoont",15546787,"Iphinstone",41509.87],
[48644524,"A1,Stone",92305923,"Marketoont",55026.94],
[98578956,"Iphinstone",15546787,"Iphinstone",11971.51],
[48644524,"A1,Stone",98578956,"Iphinstone",52679.62],
[48644524,"A1,Stone",98578956,"Iphinstone",79687.38],
[48644524,"A1,Stone",92305923,"Marketoont",58111.79],
[92305923,"Marketoont",48644524,"A1,Stone",26780.18],
[48644524,"A1,Stone",92305923,"Marketoont",15677.86],
[92305923,"Marketoont",92305923,"Marketoont",12383.13],
[48644524,"A1,Stone",15546787,"Iphinstone",41436.58],
[92305923,"Marketoont",48644524,"A1,Stone",21185.19],
[48644524,"A1,Stone",15546787,"Iphinstone",42316.59],
[48644524,"A1,Stone",98578956,"Iphinstone",31695.6],
[92305923,"Marketoont",48644524,"A1,Stone",89036.37],
[92305923,"Marketoont",92305923,"Marketoont",24365.89],
[15546787,"Iphinstone",98578956,"Iphinstone",88063.41],
[15546787,"Iphinstone",92305923,"Marketoont",121716.9],
[98578956,"Iphinstone",48644524,"A1,Stone",67481.6],
[48644524,"A1,Stone",48644524,"A1,Stone",37770.06],
[48644524,"A1,Stone",48644524,"A1,Stone",17970.72],
[92305923,"Marketoont",92305923,"Marketoont",77194.07],
[48644524,"A1,Stone",48644524,"A1,Stone",106425.7],
[98578956,"Iphinstone",15546787,"Iphinstone",56765.03],
[48644524,"A1,Stone",48644524,"A1,Stone",16192.32],
[48644524,"A1,Stone",48644524,"A1,Stone",90138.82],
[98578956,"Iphinstone",79102938,"Mach,Storage",61906.39],
[92305923,"Marketoont",92305923,"Marketoont",38514.98],
[98578956,"Iphinstone",92305923,"Marketoont",10403.36],
[92305923,"Marketoont",48644524,"A1,Stone",21083.1],
[48644524,"A1,Stone",92305923,"Marketoont",108594.6],
[92305923,"Marketoont",92305923,"Marketoont",11009.38],
[98578956,"Iphinstone",48644524,"A1,Stone",102095.8],
[48644524,"A1,Stone",92305923,"Marketoont",42791.6],
[15546787,"Iphinstone",98578956,"Iphinstone",15457.19],
[48644524,"A1,Stone",92305923,"Marketoont",52471.94],
[15546787,"Iphinstone",92305923,"Marketoont",17963.97],
[98578956,"Iphinstone",92305923,"Marketoont",28009.34],
[48644524,"A1,Stone",98578956,"Iphinstone",68936.8],
[92305923,"Marketoont",48644524,"A1,Stone",10685.67],
[48644524,"A1,Stone",98578956,"Iphinstone",95824.12],
[98578956,"Iphinstone",92305923,"Marketoont",97167.3],
[48644524,"A1,Stone",98578956,"Iphinstone",109041.4],
[92305923,"Marketoont",48644524,"A1,Stone",92858.95],
[48644524,"A1,Stone",98578956,"Iphinstone",13438.68],
[92305923,"Marketoont",98578956,"Iphinstone",58818.1],
[79102938,"Mach,Storage",92305923,"Marketoont",78395.83],
[98578956,"Iphinstone",48644524,"A1,Stone",118872.4],
[48644524,"A1,Stone",79102938,"Mach,Storage",59525.14],
[15546787,"Iphinstone",48644524,"A1,Stone",106810.3],
[15546787,"Iphinstone",98578956,"Iphinstone",72434.33],
[48644524,"A1,Stone",15546787,"Iphinstone",71076.31],
[15546787,"Iphinstone",98578956,"Iphinstone",64478.36],
[48644524,"A1,Stone",92305923,"Marketoont",8999.887],
[92305923,"Marketoont",79102938,"Mach,Storage",98902.86],
[48644524,"A1,Stone",48644524,"A1,Stone",34823.3],
[98578956,"Iphinstone",92305923,"Marketoont",11880.16],
[79102938,"Mach,Storage",98578956,"Iphinstone",23132.57],
[92305923,"Marketoont",15546787,"Iphinstone",60571.58],
[48644524,"A1,Stone",98578956,"Iphinstone",46381.85],
[48644524,"A1,Stone",15546787,"Iphinstone",59150.43],
[48644524,"A1,Stone",92305923,"Marketoont",15488.89],
[92305923,"Marketoont",98578956,"Iphinstone",18681.13],
[48644524,"A1,Stone",98578956,"Iphinstone",119419.9],
[48644524,"A1,Stone",48644524,"A1,Stone",14097.41],
[15546787,"Iphinstone",98578956,"Iphinstone",83576.26],
[92305923,"Marketoont",98578956,"Iphinstone",109506.5],
[98578956,"Iphinstone",48644524,"A1,Stone",36399.87],
[92305923,"Marketoont",98578956,"Iphinstone",76257.34],
[15546787,"Iphinstone",48644524,"A1,Stone",9275.965],
[92305923,"Marketoont",92305923,"Marketoont",31035.16],
[98578956,"Iphinstone",92305923,"Marketoont",19906.64],
[48644524,"A1,Stone",15546787,"Iphinstone",34183.38],
[48644524,"A1,Stone",79102938,"Mach,Storage",29743.97],
[92305923,"Marketoont",79102938,"Mach,Storage",106004.6],
[92305923,"Marketoont",92305923,"Marketoont",79740.06],
[92305923,"Marketoont",92305923,"Marketoont",29754.24],
[15546787,"Iphinstone",98578956,"Iphinstone",27702.07],
[98578956,"Iphinstone",92305923,"Marketoont",65075.8],
[79102938,"Mach,Storage",48644524,"A1,Stone",109507.6],
[92305923,"Marketoont",92305923,"Marketoont",55159.3],
[98578956,"Iphinstone",92305923,"Marketoont",96274.57],
[48644524,"A1,Stone",98578956,"Iphinstone",110357.3],
[98578956,"Iphinstone",15546787,"Iphinstone",47326.81],
[48644524,"A1,Stone",98578956,"Iphinstone",65735.75],
[79102938,"Mach,Storage",15546787,"Iphinstone",5951.842],
[92305923,"Marketoont",98578956,"Iphinstone",9839.477],
[98578956,"Iphinstone",98578956,"Iphinstone",56220.88],
[48644524,"A1,Stone",48644524,"A1,Stone",94530.18],
[48644524,"A1,Stone",98578956,"Iphinstone",44393.73],
[15546787,"Iphinstone",48644524,"A1,Stone",78294.1],
[92305923,"Marketoont",92305923,"Marketoont",48875.36],
[92305923,"Marketoont",15546787,"Iphinstone",52209.67],
[92305923,"Marketoont",98578956,"Iphinstone",93452.71],
[92305923,"Marketoont",98578956,"Iphinstone",104840.8],
[98578956,"Iphinstone",98578956,"Iphinstone",54369.72],
[48644524,"A1,Stone",98578956,"Iphinstone",17615.3],
[92305923,"Marketoont",79102938,"Mach,Storage",61202.0],
[15546787,"Iphinstone",48644524,"A1,Stone",65046.23],
[92305923,"Marketoont",15546787,"Iphinstone",75004.05],
[98578956,"Iphinstone",98578956,"Iphinstone",76508.46],
[15546787,"Iphinstone",98578956,"Iphinstone",50783.63],
[98578956,"Iphinstone",79102938,"Mach,Storage",111170.3],
[98578956,"Iphinstone",92305923,"Marketoont",11661.85],
[92305923,"Marketoont",92305923,"Marketoont",17732.08],
[92305923,"Marketoont",79102938,"Mach,Storage",90590.48],
[48644524,"A1,Stone",92305923,"Marketoont",36265.01],
[15546787,"Iphinstone",79102938,"Mach,Storage",8419.871],
[92305923,"Marketoont",92305923,"Marketoont",7125.722],
[48644524,"A1,Stone",92305923,"Marketoont",23348.66],
[92305923,"Marketoont",48644524,"A1,Stone",126299.9],
[15546787,"Iphinstone",92305923,"Marketoont",28618.25],
[98578956,"Iphinstone",15546787,"Iphinstone",96296.75],
[48644524,"A1,Stone",98578956,"Iphinstone",14948.88],
[48644524,"A1,Stone",98578956,"Iphinstone",63159.11],
[48644524,"A1,Stone",48644524,"A1,Stone",125867.3],
[79102938,"Mach,Storage",98578956,"Iphinstone",69040.32],
[15546787,"Iphinstone",48644524,"A1,Stone",47024.19],
[48644524,"A1,Stone",48644524,"A1,Stone",95888.34],
[98578956,"Iphinstone",92305923,"Marketoont",15480.74],
[92305923,"Marketoont",92305923,"Marketoont",40072.27],
[92305923,"Marketoont",48644524,"A1,Stone",104184.6],
[48644524,"A1,Stone",98578956,"Iphinstone",124006.0],
[79102938,"Mach,Storage",48644524,"A1,Stone",50788.72],
[92305923,"Marketoont",92305923,"Marketoont",88506.62],
[48644524,"A1,Stone",98578956,"Iphinstone",47408.32],
[72321311,"Iphinstone",72321311,"Iphinstone",44107.11],
[72321311,"Iphinstone",72321311,"Iphinstone",51685.13],
[72321311,"Iphinstone",16235167,"Marketoont",5466.507],
[16235167,"Marketoont",72321311,"Iphinstone",80434.97],
[72321311,"Iphinstone",72321311,"Iphinstone",95396.8],
[16235167,"Marketoont",70898547,"Iphinstone",75873.4],
[72321311,"Iphinstone",72321311,"Iphinstone",12768.33],
[16235167,"Marketoont",72321311,"Iphinstone",63575.24],
[72321311,"Iphinstone",70898547,"Iphinstone",32269.04],
[70898547,"Iphinstone",16235167,"Marketoont",3001.652],
[70898547,"Iphinstone",70898547,"Iphinstone",91166.5],
[72321311,"Iphinstone",72321311,"Iphinstone",49360.76],
[72321311,"Iphinstone",70898547,"Iphinstone",22275.51],
[16235167,"Marketoont",16235167,"Marketoont",38514.08],
[70898547,"Iphinstone",72321311,"Iphinstone",33287.26],
[70898547,"Iphinstone",72321311,"Iphinstone",41497.05],
[72321311,"Iphinstone",16235167,"Marketoont",25063.23],
[72321311,"Iphinstone",70898547,"Iphinstone",21081.87],
[70898547,"Iphinstone",70898547,"Iphinstone",71310.22],
[70898547,"Iphinstone",72321311,"Iphinstone",96280.19],
[70898547,"Iphinstone",70898547,"Iphinstone",82910.01],
[16235167,"Marketoont",72321311,"Iphinstone",101337.4],
[16235167,"Marketoont",16235167,"Marketoont",46062.43],
[16235167,"Marketoont",72321311,"Iphinstone",45020.31],
[70898547,"Iphinstone",16235167,"Marketoont",28612.49],
[16235167,"Marketoont",16235167,"Marketoont",96700.49],
[72321311,"Iphinstone",16235167,"Marketoont",15128.62],
[70898547,"Iphinstone",70898547,"Iphinstone",67171.76],
[16235167,"Marketoont",70898547,"Iphinstone",15237.04],
[72321311,"Iphinstone",16235167,"Marketoont",25531.06],
[16235167,"Marketoont",72321311,"Iphinstone",39802.05],
[16235167,"Marketoont",72321311,"Iphinstone",79379.67],
[72321311,"Iphinstone",16235167,"Marketoont",46703.59],
[72321311,"Iphinstone",16235167,"Marketoont",10578.38],
[16235167,"Marketoont",16235167,"Marketoont",54708.23],
[72321311,"Iphinstone",72321311,"Iphinstone",89796.74],
[16235167,"Marketoont",72321311,"Iphinstone",79594.32],
[72321311,"Iphinstone",72321311,"Iphinstone",80934.42],
[72321311,"Iphinstone",16235167,"Marketoont",108769.5],
[16235167,"Marketoont",16235167,"Marketoont",53880.17],
[16235167,"Marketoont",72321311,"Iphinstone",4227.608],
[16235167,"Marketoont",16235167,"Marketoont",110008.8],
[72321311,"Iphinstone",70898547,"Iphinstone",73685.66],
[72321311,"Iphinstone",16235167,"Marketoont",18429.32],
[16235167,"Marketoont",16235167,"Marketoont",53891.72],
[16235167,"Marketoont",72321311,"Iphinstone",4309.832],
[16235167,"Marketoont",16235167,"Marketoont",74305.09],
[72321311,"Iphinstone",70898547,"Iphinstone",71445.99],
[72321311,"Iphinstone",72321311,"Iphinstone",65991.15],
[72321311,"Iphinstone",16235167,"Marketoont",10232.66],
[72321311,"Iphinstone",70898547,"Iphinstone",5400.25],
[16235167,"Marketoont",16235167,"Marketoont",104614.5],
[70898547,"Iphinstone",70898547,"Iphinstone",61191.36],
[70898547,"Iphinstone",16235167,"Marketoont",43596.52],
[16235167,"Marketoont",70898547,"Iphinstone",43101.51],
[16235167,"Marketoont",16235167,"Marketoont",65995.69],
[72321311,"Iphinstone",70898547,"Iphinstone",65416.45],
[16235167,"Marketoont",16235167,"Marketoont",70866.77],
[16235167,"Marketoont",72321311,"Iphinstone",30754.3],
[16235167,"Marketoont",16235167,"Marketoont",32780.49],
[16235167,"Marketoont",16235167,"Marketoont",99760.93],
[70898547,"Iphinstone",70898547,"Iphinstone",82697.16],
[72321311,"Iphinstone",16235167,"Marketoont",40522.38],
[16235167,"Marketoont",72321311,"Iphinstone",45068.51],
[72321311,"Iphinstone",72321311,"Iphinstone",69265.77],
[16235167,"Marketoont",16235167,"Marketoont",38293.93],
[16235167,"Marketoont",70898547,"Iphinstone",93591.95],
[16235167,"Marketoont",16235167,"Marketoont",39889.44],
[72321311,"Iphinstone",16235167,"Marketoont",67519.89],
[16235167,"Marketoont",72321311,"Iphinstone",98028.1],
[72321311,"Iphinstone",16235167,"Marketoont",37966.61],
[70898547,"Iphinstone",72321311,"Iphinstone",36635.61],
[70898547,"Iphinstone",70898547,"Iphinstone",66281.58],
[72321311,"Iphinstone",72321311,"Iphinstone",17854.92],
[16235167,"Marketoont",70898547,"Iphinstone",101518.0],
[72321311,"Iphinstone",72321311,"Iphinstone",90825.81],
[70898547,"Iphinstone",70898547,"Iphinstone",52743.37],
[72321311,"Iphinstone",72321311,"Iphinstone",85507.45],
[72321311,"Iphinstone",70898547,"Iphinstone",79409.74],
[16235167,"Marketoont",72321311,"Iphinstone",34846.23],
[72321311,"Iphinstone",16235167,"Marketoont",23150.27],
[72321311,"Iphinstone",16235167,"Marketoont",64461.75],
[16235167,"Marketoont",70898547,"Iphinstone",61189.08],
[16235167,"Marketoont",70898547,"Iphinstone",81971.93],
[72321311,"Iphinstone",16235167,"Marketoont",88125.81],
[16235167,"Marketoont",72321311,"Iphinstone",126330.9],
[72321311,"Iphinstone",16235167,"Marketoont",50829.43],
[70898547,"Iphinstone",70898547,"Iphinstone",24073.12],
[70898547,"Iphinstone",70898547,"Iphinstone",69287.81],
[70898547,"Iphinstone",16235167,"Marketoont",12093.79],
[72321311,"Iphinstone",72321311,"Iphinstone",92444.23],
[70898547,"Iphinstone",16235167,"Marketoont",93148.05],
[16235167,"Marketoont",72321311,"Iphinstone",40868.26],
[16235167,"Marketoont",16235167,"Marketoont",46376.39],
[70898547,"Iphinstone",70898547,"Iphinstone",87652.54],
[16235167,"Marketoont",70898547,"Iphinstone",95504.78],
[16235167,"Marketoont",16235167,"Marketoont",113970.5],
[16235167,"Marketoont",72321311,"Iphinstone",55957.36],
[16235167,"Marketoont",16235167,"Marketoont",103300.0],
[70898547,"Iphinstone",16235167,"Marketoont",118981.2],
[16235167,"Marketoont",72321311,"Iphinstone",59513.91],
[70898547,"Iphinstone",70898547,"Iphinstone",12666.26]]

[48644524, 96877928, 35673565, 16235167, 98578956, 68362850]

import numpy as np
import pandas as pd

csv = pd.DataFrame(main_database, columns=['Seller_ID','Seller_CO','Buyer_ID','Buyer_CO','Tran_PR'])

def deep_path(summit, visited, adg_list, pile) :
    visited[summit] = True
    for i in adg_list[summit] :
        if not visited[i] :
            pile = deep_path(i, visited, adg_list, pile)
    return pile + [summit]

def deep_first(summit, visited, adg_matrix, connexe) :
    visited[summit] = True
    for i in range(len(adg_matrix[summit])) :
        if not visited[i] and adg_matrix[summit][i] :
            connexe = deep_first(i, visited, adg_matrix, connexe)
    return connexe + [summit]

def group_by_sum(indexs, data, index_sum) :
    unique = np.unique(data[:,indexs], axis=0)
    sums = np.fromiter((np.sum(np.asarray(data[:,index_sum], dtype =float), where=np.all(data[:,indexs] == line, axis = 1)) for line in unique), dtype = float, count = len(unique))
    return np.concatenate((unique, np.resize(sums, (len(sums), 1))), axis =1)

def find_main_fraudsterV1(csv):
    
    #main_database = pd.read_csv(csv)
    
    # CODE HERE
    main_database = np.asarray(csv.to_numpy()[:,[2,0,4]], dtype = float)

    main_database_cleaned = main_database[main_database[:,0] != main_database[:,1]]
    unique = np.unique(main_database_cleaned[:,:2], axis=0)
    
    sums = np.fromiter((np.sum(np.asarray(main_database_cleaned[:,-1], dtype =float), where=np.all(main_database_cleaned[:,:2] == line, axis = 1)) for line in unique), dtype = float, count = len(unique))
    group_by = np.concatenate((unique, np.resize(sums, (len(sums), 1))), axis =1)

    id_to_index = {group_by[0][0] : 0}
    index_to_id = [group_by[0][0]]
    money_of_index = [group_by[0][2]]
    group_by[0][0] = 0
    nb_of_ids = 1
    for i in range(1, len(group_by)) :
        if group_by[i][0] not in id_to_index :
            id_to_index[group_by[i][0]] = nb_of_ids
            index_to_id.append(group_by[i][0])
            money_of_index.append(group_by[i][2])
            group_by[i][0] = nb_of_ids
            nb_of_ids += 1
        else :
            money_of_index[id_to_index[group_by[i][0]]] += group_by[i][2]
            group_by[i][0] = id_to_index[group_by[i][0]]


    adg_list = [[] for i in range(nb_of_ids)]
    for i in range(len(group_by)) :
        adg_list[int(group_by[i][0])].append(id_to_index[group_by[i][1]])


    visited = [False] * nb_of_ids
    pile = []
    for i in range(len(visited)) :
        if not visited[i] :
            pile.append(deep_path(i, visited, adg_list, []))


    connexe_size = 0
    longest_connext = []
    for connexe in pile :
        if len(connexe) >= connexe_size :
            longest_connext = connexe
            connexe_size = len(connexe)

    money = -1
    richest_index = -1
    for index in longest_connext :
        if money_of_index[index] >= money :
            richest_index = index
            money = money_of_index[index]

    #print(unique)
    
    # The function should return the company ID belonging to the company which received 
    # the highest amount of money while being connected to the highest number of companies.
    return int(index_to_id[richest_index])

def find_main_fraudsterV2(csv):
    
    #main_database = pd.read_csv(csv)
    
    # CODE HERE
    main_database = np.asarray(csv.to_numpy()[:,[2,0,4]], dtype = float)
    main_database_cleaned = main_database[main_database[:,0] != main_database[:,1]]
    group_by = group_by_sum([0,1],main_database_cleaned,-1)

    id_to_index = {group_by[0][0] : 0}
    index_to_id = [group_by[0][0]]
    money_of_index = [group_by[0][2]]
    group_by[0][0] = 0
    nb_of_ids = 1
    for i in range(1, len(group_by)) :
        if group_by[i][0] not in id_to_index :
            id_to_index[group_by[i][0]] = nb_of_ids
            index_to_id.append(group_by[i][0])
            money_of_index.append(group_by[i][2])
            group_by[i][0] = nb_of_ids
            nb_of_ids += 1
        else :
            money_of_index[id_to_index[group_by[i][0]]] += group_by[i][2]
            group_by[i][0] = id_to_index[group_by[i][0]]


    adg_list = [[] for i in range(nb_of_ids)]
    for i in range(len(group_by)) :
        adg_list[int(group_by[i][0])].append(id_to_index[group_by[i][1]])


    visited = [False] * nb_of_ids
    pile = []
    for i in range(len(visited)) :
        if not visited[i] :
            pile.append(deep_path(i, visited, adg_list, []))


    connexe_size = 0
    longest_connext = []
    for connexe in pile :
        if len(connexe) >= connexe_size :
            longest_connext = connexe
            connexe_size = len(connexe)

    money = -1
    richest_index = -1
    for index in longest_connext :
        if money_of_index[index] >= money :
            richest_index = index
            money = money_of_index[index]

    #print(unique)
    
    # The function should return the company ID belonging to the company which received 
    # the highest amount of money while being connected to the highest number of companies.
    return int(index_to_id[richest_index])

def find_main_fraudsterV3(csv):
    
    #main_database = pd.read_csv(csv)
    
    # CODE HERE
    main_database = np.asarray(csv.to_numpy()[:,[2,0,4]], dtype = float)
    main_database_cleaned = main_database[main_database[:,0] != main_database[:,1]]
    group_by = group_by_sum([0,1],main_database_cleaned,-1)

    id_to_index = {group_by[0][0] : 0}
    index_to_id = [group_by[0][0]]
    group_by[0][0] = 0
    nb_of_ids = 1
    for i in range(1, len(group_by)) :
        if group_by[i][0] not in id_to_index :
            id_to_index[group_by[i][0]] = nb_of_ids
            index_to_id.append(group_by[i][0])
            group_by[i][0] = nb_of_ids
            nb_of_ids += 1
        else :
            group_by[i][0] = id_to_index[group_by[i][0]]


    adg_list = [[] for i in range(nb_of_ids)]
    for i in range(len(group_by)) :
        adg_list[int(group_by[i][0])].append(id_to_index[group_by[i][1]])


    visited = [False] * nb_of_ids
    pile = []
    for i in range(len(visited)) :
        if not visited[i] :
            pile.append(deep_path(i, visited, adg_list, []))

    connexe_size = 0
    longest_connext = []
    for connexe in pile :
        if len(connexe) >= connexe_size :
            longest_connext = connexe
            connexe_size = len(connexe)

    money_by_index = group_by_sum([0], group_by, -1)

    max_money = -1
    richest_index = -1
    for index in longest_connext :
        if money_by_index[index][1] >= max_money :
            richest_index = index
            max_money = money_by_index[index][1]
    
    #print(unique)
    
    # The function should return the company ID belonging to the company which received 
    # the highest amount of money while being connected to the highest number of companies.
    return int(index_to_id[richest_index])

def find_main_fraudsterV4(csv):
    
    #main_database = pd.read_csv(csv)
    
    # CODE HERE

    #On récupère uniquement les ids et les montants des transactions, + on inverse les colonnes acheteurs / vendeurs
    main_database = np.asarray(csv.to_numpy()[:,[2,0,4]], dtype = float)

    #Suppresion les lignes inutiles. ie : les transactions ou l'acheteur est le même que le vendeur
    main_database_cleaned = main_database[main_database[:,0] != main_database[:,1]]

    #Réunion les lignes ou l'acheteur et le vendeur sont les même et on fait la somme des montants des transactions
    group_by = group_by_sum([0,1],main_database_cleaned,-1)

    #Création une bijection entre les ids des entreprises et les indexs d'un tableau tout en réalisant la somme des montants reçu pour chaque entreprise
    id_to_index = {group_by[0][0] : 0}
    index_to_id = [group_by[0][0]]
    money_of_index = [group_by[0][2]]
    group_by[0][0] = 0
    nb_of_ids = 1
    for i in range(1, len(group_by)) :
        if group_by[i][0] not in id_to_index :
            id_to_index[group_by[i][0]] = nb_of_ids
            index_to_id.append(group_by[i][0])
            money_of_index.append(group_by[i][2])
            group_by[i][0] = nb_of_ids
            nb_of_ids += 1
        else :
            money_of_index[id_to_index[group_by[i][0]]] += group_by[i][2]
            group_by[i][0] = id_to_index[group_by[i][0]]
    
    for i in range(0, len(group_by)) :
        group_by[i][1] = id_to_index[group_by[i][1]]

    #Création de la liste d'adjacence du graph
    to_create_adg_list = np.concatenate((group_by[:,[0,1]], group_by[:,[1,0]])) #Désorientation des arrêtes
    to_create_adg_list = np.asarray(np.unique(to_create_adg_list, axis =0), dtype = int) #Mise en forme du tableau
    
    adg_list = [[] for i in range(nb_of_ids)] #formation de la liste
    for i in range(len(to_create_adg_list)) :
        adg_list[to_create_adg_list[i][0]].append(to_create_adg_list[i][1])

    #Parcours du graph en profondeur, pour récupérer les composantes connexes
    visited = [False] * nb_of_ids
    connexes = [] #Liste des composantes connexes
    for i in range(len(visited)) :
        if not visited[i] :
            connexes.append(deep_path(i, visited, adg_list, []))

    #Détermination de la composante connexe de plus grande taille
    connexe_size = 0
    longest_connext = []
    for connexe in connexes :
        if len(connexe) >= connexe_size :
            longest_connext = connexe
            connexe_size = len(connexe)

    #Détermination de l'entreprise la plus riche parmis la plus grande composante connexe
    money = -1
    richest_index = -1
    for index in longest_connext :
        if money_of_index[index] >= money :
            richest_index = index
            money = money_of_index[index]
    
    # The function should return the company ID belonging to the company which received 
    # the highest amount of money while being connected to the highest number of companies.
    return int(index_to_id[richest_index])

def find_main_fraudsterV5(csv):
    
    #main_database = pd.read_csv(csv)
    
    # CODE HERE

    #On récupère uniquement les ids et les montants des transactions
    main_database = np.asarray(csv.to_numpy(dtype = str))
    
    #Suppresion les lignes inutiles. ie : les transactions ou l'acheteur est le même que le vendeur
    main_database_cleaned = main_database[main_database[:,1] != main_database[:,3]]
    main_database_cleaned = np.asarray(main_database_cleaned[:,[0,2,4]], dtype = float)
    #Réunion les lignes ou l'acheteur et le vendeur sont les même et on fait la somme des montants des transactions
    group_by = group_by_sum([0,1],main_database_cleaned,-1)

    #Création une bijection entre les ids des entreprises et les indexs d'un tableau tout en réalisant la somme des montants reçu pour chaque entreprise
    id_to_index = {group_by[0][0] : 0}
    index_to_id = [group_by[0][0]]
    money_of_index = [group_by[0][2]]
    group_by[0][0] = 0
    nb_of_ids = 1
    for i in range(1, len(group_by)) :
        if group_by[i][0] not in id_to_index :
            id_to_index[group_by[i][0]] = nb_of_ids
            index_to_id.append(group_by[i][0])
            money_of_index.append(group_by[i][2])
            group_by[i][0] = nb_of_ids
            nb_of_ids += 1
        else :
            money_of_index[id_to_index[group_by[i][0]]] += group_by[i][2]
            group_by[i][0] = id_to_index[group_by[i][0]]
    
    #money_of_index = [0] * nb_of_ids
    for i in range(0, len(group_by)) :
        group_by[i][1] = id_to_index[group_by[i][1]]
        #money_of_index[int(group_by[i][0])] += group_by[i][2]
        #money_of_index[int(group_by[i][1])] -= group_by[i][2]
    
    print(money_of_index)

    #Création de la liste d'adjacence du graph
    to_create_adg_list = np.concatenate((group_by[:,[0,1]], group_by[:,[1,0]])) #Désorientation des arrêtes
    to_create_adg_list = np.asarray(np.unique(to_create_adg_list, axis =0), dtype = int) #Mise en forme du tableau
    
    adg_list = [[] for i in range(nb_of_ids)] #formation de la liste
    for i in range(len(to_create_adg_list)) :
        adg_list[to_create_adg_list[i][0]].append(to_create_adg_list[i][1])

    #Parcours du graph en profondeur, pour récupérer les composantes connexes
    visited = [False] * nb_of_ids
    connexes = [] #Liste des composantes connexes
    for i in range(len(visited)) :
        if not visited[i] :
            connexes.append(deep_path(i, visited, adg_list, []))
    print(connexes)

    #Détermination de la composante connexe de plus grande taille
    connexe_size = 0
    longest_connext = []
    for connexe in connexes :
        if len(connexe) >= connexe_size :
            longest_connext = connexe
            connexe_size = len(connexe)

    #Détermination de l'entreprise la plus riche parmis la plus grande composante connexe
    money = longest_connext[0]
    richest_index = 0
    for i in range(len(longest_connext)) :
        if money_of_index[longest_connext[i]] >= money :
            richest_index = longest_connext[i]
            money = money_of_index[longest_connext[i]]
    
    # The function should return the company ID belonging to the company which received 
    # the highest amount of money while being connected to the highest number of companies.
    return int(index_to_id[richest_index])

def find_main_fraudsterV6(csv):
    
    #main_database = pd.read_csv(csv)
    
    # CODE HERE

    #On récupère uniquement les ids et les montants des transactions
    main_database = np.asarray(csv.to_numpy(dtype = str)[:,[1,3,4]])
    
    #Suppresion les lignes inutiles. ie : les transactions ou l'acheteur est le même que le vendeur
    main_database_cleaned = main_database[main_database[:,0] != main_database[:,1]]
    
    #Réunion les lignes ou l'acheteur et le vendeur sont les même et on fait la somme des montants des transactions
    group_by = group_by_sum([0,1],main_database_cleaned,-1)

    #Création une bijection entre les ids des entreprises et les indexs d'un tableau tout en réalisant la somme des montants reçu pour chaque entreprise
    id_to_index = {group_by[0][0] : 0}
    index_to_id = [group_by[0][0]]
    #money_of_index = [float(group_by[0][2])]
    group_by[0][0] = 0
    nb_of_ids = 1
    for i in range(1, len(group_by)) :
        if group_by[i][0] not in id_to_index :
            id_to_index[group_by[i][0]] = nb_of_ids
            index_to_id.append(group_by[i][0])
            #money_of_index.append(float(group_by[i][2]))
            group_by[i][0] = nb_of_ids
            nb_of_ids += 1
        else :
            #money_of_index[id_to_index[group_by[i][0]]] += float(group_by[i][2])
            group_by[i][0] = id_to_index[group_by[i][0]]
    
    money_of_index = [0] * nb_of_ids
    for i in range(0, len(group_by)) :
        group_by[i][1] = id_to_index[group_by[i][1]]
        money_of_index[int(group_by[i][0])] += float(group_by[i][2])
        money_of_index[int(group_by[i][1])] -= float(group_by[i][2])
    
    print(money_of_index)

    #Création de la liste d'adjacence du graph
    to_create_adg_list = np.concatenate((group_by[:,[0,1]], group_by[:,[1,0]])) #Désorientation des arrêtes
    to_create_adg_list = np.asarray(np.unique(to_create_adg_list, axis =0), dtype = int) #Mise en forme du tableau
    
    adg_list = [[] for i in range(nb_of_ids)] #formation de la liste
    for i in range(len(to_create_adg_list)) :
        adg_list[to_create_adg_list[i][0]].append(to_create_adg_list[i][1])

    #Parcours du graph en profondeur, pour récupérer les composantes connexes
    visited = [False] * nb_of_ids
    connexes = [] #Liste des composantes connexes
    for i in range(len(visited)) :
        if not visited[i] :
            connexes.append(deep_path(i, visited, adg_list, []))
    print(connexes)

    #Détermination de la composante connexe de plus grande taille
    connexe_size = 0
    longest_connext = []
    for connexe in connexes :
        if len(connexe) >= connexe_size :
            longest_connext = connexe
            connexe_size = len(connexe)

    #Détermination de l'entreprise la plus riche parmis la plus grande composante connexe
    money = longest_connext[0]
    richest_index = 0
    for i in range(len(longest_connext)) :
        if money_of_index[longest_connext[i]] >= money :
            richest_index = longest_connext[i]
            money = money_of_index[longest_connext[i]]
    
    # The function should return the company ID belonging to the company which received 
    # the highest amount of money while being connected to the highest number of companies.
    return index_to_id[richest_index]

import math

def find_main_fraudsterV7(csv) : #groupby by pandas
    #database = pd.read_csv(csv)
    database = csv

    # CODE HERE

    #On ne prend pas en compte les transactions des succursales
    database.loc[database['Seller_CO'] == database['Buyer_CO'], 'Tran_PR'] = 0

    #Bijection index & ids (à noter que unique tri les id par ordre croissants nous utiliserons cette propriété par la suite)
    
    index_to_ids = np.unique(np.concatenate((database['Seller_ID'].to_numpy(), database['Buyer_ID'].to_numpy())))


    #Création d'une demi matrice d'adjacence
    adj_matrix = database.groupby(['Seller_ID','Buyer_ID'])['Tran_PR'].sum().unstack(level='Buyer_ID').to_numpy(dtype = float)#unstack fait des collonnes de buyer id en inscrivant Nan si le buyer n'a pas acheter au seller correspondant à la ligne et la somme sinon. (les indices sont numéroter par ordre croissants on va donc pouvoir utiliser buyer_to_id)
    
    #Calcul de l'argent reçu par chaque entreprise
    money_received = np.nansum(adj_matrix, axis = 1) #par construction l'argent reçu par un seller est la somme d'une ligne

    #Symétrisation de la matrice (utile pour explorer le réseau que l'on considérer comme un graphe non orienté)
    for i in range(len(adj_matrix)) :
        for j in range(len(adj_matrix)) :
            if not math.isnan(adj_matrix[i][j]) :
                    adj_matrix[i][j] = 1
                    adj_matrix[j][i] = 1
            else :
                adj_matrix[i][j] = 0
    
    #Détermination des composantes connexes (utilisation d'un DFS)
    visited = [False] * len(index_to_ids)
    connexes = []
    for i in range(len(adj_matrix)) :
        if not visited[i] :
            connexes.append(deep_first(i, visited, adj_matrix, []))
    
    #Détermination de la plus grande partie connexe
    longest_connex = connexes[0]
    connexe_lenght = len(connexes[0])
    for i in range(1, len(connexes)) :
        if len(connexes[i]) > connexe_lenght :
            longest_connex = connexes[i]
            connexe_lenght = len(connexes[i])

    #Détermination de la compagnie qui a reçut le plus d'argent dans la plus grande partie connexe
    richest_index = longest_connex[0]
    index_money = money_received[0]
    for i in range(1, len(longest_connex)) :
        if money_received[longest_connex[i]] > index_money :
            richest_index = longest_connex[i]
            index_money = money_received[longest_connex[i]]
    
    # The function should return the company ID belonging to the company which received 
    # the highest amount of money while being connected to the highest number of companies.
    return index_to_ids[richest_index]

find_main_fraudsterV7(csv)
import time

"""
nb_of_iter = 1000
print("Pour : " + str(nb_of_iter) + " itérations")
start_time = time.time_ns()
for i in range(nb_of_iter) :
    find_main_fraudsterV1(csv)
print("V1 : %s seconds " % ((time.time_ns() - start_time) / 10**9 ))

start_time = time.time_ns()
for i in range(nb_of_iter) :
    find_main_fraudsterV2(csv)
print("V2 : %s seconds " % ((time.time_ns() - start_time) / 10**9 ))

start_time = time.time_ns()
for i in range(nb_of_iter) :
    find_main_fraudsterV3(csv)
print("V3 : %s seconds " % ((time.time_ns() - start_time) / 10**9 ))

start_time = time.time_ns()
for i in range(nb_of_iter) :
    find_main_fraudsterV4(csv)
print("V4 : %s seconds " % ((time.time_ns() - start_time) / 10**9 ))

if find_main_fraudsterV1(csv) == find_main_fraudsterV2(csv) == find_main_fraudsterV3(csv) == find_main_fraudsterV4(csv) :
    print("\nevery body agreed on id : " + str(find_main_fraudsterV1(csv)))
else :
    print("There are diffrents responses")
"""
